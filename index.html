<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Leaflet - Image fig√©e ou zoomable</title>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="">
<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

<style>
  html, body { height: 100%; margin: 0; }
  #map { width: 100%; height: 100vh; }
  #fixedImage {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 300px;
    border: 2px solid #555;
    display: none; /* cach√©e par d√©faut */
    z-index: 999;
  }
  .leaflet-top.leaflet-left {
    margin-top: 60px; /* espace pour les boutons */
  }
  .custom-btn {
    background: white;
    border: 2px solid #666;
    border-radius: 5px;
    padding: 6px 10px;
    margin: 5px;
    cursor: pointer;
    font-weight: bold;
  }
  .custom-btn:hover {
    background: #f0f0f0;
  }
</style>
</head>
<body>

<div id="map"></div>

<!-- Image fig√©e -->
<img id="fixedImage" src="0.png" alt="Image fig√©e">

<script>
  // --- Initialisation de la carte ---
  var map = L.map('map', {
    center: [44.5102, -88.0233],
    zoom: 17,
    zoomSnap: 0.25,
    zoomDelta: 0.5
  });

  // --- Fond OSM ---
  L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap'
  }).addTo(map);

  // --- Limites g√©ographiques de l‚Äôimage ---
  var bounds = [
    [44.509581, -88.0242333], // SW
    [44.510931, -88.0222975]  // NE
  ];

  // --- Image synchronis√©e (g√©or√©f√©renc√©e) ---
  var geoImage = L.imageOverlay('0.png', bounds, {opacity: 0.9});

  // --- Rectangle de rep√®re ---
  var rect = L.rectangle(bounds, {color: "#ff7800", weight: 2, fill: false}).addTo(map);
  map.fitBounds(bounds);

  // --- Ajout des boutons personnalis√©s ---
  var FixedControl = L.Control.extend({
    onAdd: function() {
      var div = L.DomUtil.create('div');
      div.innerHTML = `
        <button class="custom-btn" id="btnFixed">üßä Image fig√©e</button><br>
        <button class="custom-btn" id="btnGeo">üîç Image zoomable</button>
      `;
      return div;
    }
  });

  map.addControl(new FixedControl({position: 'topright'}));

  // --- Gestion des clics sur les boutons ---
  document.getElementById('btnFixed').addEventListener('click', function() {
    map.removeLayer(geoImage);           // retirer image g√©o
    document.getElementById('fixedImage').style.display = 'block'; // montrer image fig√©e
  });

  document.getElementById('btnGeo').addEventListener('click', function() {
    document.getElementById('fixedImage').style.display = 'none'; // cacher image fig√©e
    geoImage.addTo(map); // afficher image g√©or√©f√©renc√©e
    map.fitBounds(bounds);
  });

  // --- Popup coordonn√©es au clic ---
  map.on('click', function(e) {
    L.popup()
      .setLatLng(e.latlng)
      .setContent("Lat: " + e.latlng.lat.toFixed(6) + "<br>Lon: " + e.latlng.lng.toFixed(6))
      .openOn(map);
  });

</script>

</body>
</html>
